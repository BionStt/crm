parameters:
  services: ''

jobs:
  - job: Build_service
    displayName: Build services
    dependsOn: Prepare_environment
    variables:
      shortcommit: $[dependencies.Prepare_environment.outputs['setGlobalVarStep.shortcommit']]
    pool:
      name: default
    steps:            
      - task: DockerCompose@0
        displayName: Compose build ${{ parameters.services }}
        inputs:
          dockerComposeCommand: 'build ${{ parameters.services }}'
          containerregistrytype: Container Registry
          dockerComposeFile: docker-compose.yml
          qualifyImageNames: true
          projectName: ''
          dockerComposeFileArgs: |
            TAG=$(shortcommit)