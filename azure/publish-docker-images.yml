parameters:
  services: ''
  registryEndpoint: ''

jobs:
  - job: Publish_Docker_Images
    displayName: Publish images
    variables:
      dockerImageTag: $[dependencies.Prepare_environment.outputs['setGlobalVarStep.dockerImageTag']]
    dependsOn:
    - Prepare_environment
    pool:
      name: default
    steps:
      - task: DockerCompose@0
        displayName: Compose push ${{ parameters.services }}
        inputs:
          dockerComposeCommand: 'push ${{ parameters.services }}'
          containerregistrytype: Container Registry
          dockerRegistryEndpoint: ${{ parameters.registryEndpoint }}
          dockerComposeFile: docker-compose.yml
          qualifyImageNames: true
          projectName: ""
          dockerComposeFileArgs: |
            TAG=$(dockerImageTag)
